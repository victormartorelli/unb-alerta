{% extends "base.html"%}
{% block content %}
    <style>
      #map {
        width: 525px;
        height: 400px;
      }
    </style>

  <div id = "fundo">
    <div class="container">
    <div class="row vertical-offset-100">
      <div class="col-md-6 col-md-offset-3">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Cadastro</h3>
          </div>

          <div class="panel-body">
            <form action="demo_form.asp" accept-charset="UTF-8" role="form">
                    <fieldset>
			   <div id="map"></div>
    <script>
      
      function initMap() {
        var mapDiv = document.getElementById('map');
        var map = new google.maps.Map(mapDiv, {
          center: {lat: -15.763606, lng: -47.869636},
          zoom: 17
        });
        google.maps.event.addListener(map, 'click', function(event) {
           posicionaMarcador(event.latLng);       
        });
        
        var marcador;
        function posicionaMarcador(posicao){
          document.getElementById("posicao").value = posicao;
          document.getElementById("resultado").innerHTML = posicao;
          
          if (marcador){
            marcador.setPosition(posicao);
          } else {          
            // Inserindo o marcador
            marcador = new google.maps.Marker({
              position: posicao,
              map: map,
              icon: {
                //path: google.maps.SymbolPath.CIRCLE,
                fillColor: 'red',
                fillOpacity: .2,
                strokeColor: 'white',
                strokeWeight: .5,
                scale: 10
              }
            });
          }  
        }
      }
      
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?callback=initMap"
        async defer></script>
        <form action="" method="post">
              <div class="form-group">
                <p>Tipo:</p>
                  {{ form.tb_categoria_id }}
              </div>
              <div class="form-group">
                <p>Emergencia?</p>
                {{ form.emergencia }}
              </div>
              <div class="form-group">
               Descrição: </br>{{ form.descricao }}
              </div>
              <div class="form-group">
			   <p>imagem:</p>
               <input type="file" name="imagem"/>
              </div>
              <input type="hidden" id="posicao" name="posicao" value="">
              <input class="btn btn-lg btn-success btn-block" type="submit" value="Criar ocorrencia">
              <div id="resultado"></div>
            </fieldset>
            
              </form>
          </div>
          <input type="submit" />
          </form>
          </div>
        </div>
    </div>
  <div>
{% endblock %}
